-- ========================================
-- CUSTOM UI LIBRARY
-- A fully reusable UI library for Roblox exploits
-- Now with Debugger Window
-- ========================================

--[[
    HOW TO USE:
    
    local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/CreativeUsername228/Den-s-GUI-Library/refs/heads/main/Lua%20UI"))()
    
    local Window = Library:CreateWindow({
        Title = "My Script",
        Subtitle = "by @username",
        Theme = "Purple", -- Purple, Blue, Red, Green, Orange, Pink
        Size = {550, 400},
        ToggleKey = Enum.KeyCode.K
    })
    
    -- New: Debugger automatically created
    -- Access it via: Library.Debugger
    
    -- Add debugger toggle to any tab:
    Library:CreateDebuggerToggle(Tab)
    
    local Tab = Window:CreateTab("Tab Name")
    local MiscTab = Window:CreateTab("Misc")
    
    Library:CreateDebuggerToggle(MiscTab) -- Adds debugger toggle to Misc tab
    
    Tab:AddToggle({
        Name = "Toggle Name",
        Default = false,
        Callback = function(value)
            print(value)
        end
    })
--]]

local Library = {}
Library.__index = Library

-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer

-- Theme colors
local Themes = {
    Purple = {
        Main = Color3.fromRGB(120, 80, 160),
        Light = Color3.fromRGB(150, 100, 200),
        Dark = Color3.fromRGB(100, 60, 140),
        Debug = Color3.fromRGB(160, 90, 210)
    },
    Blue = {
        Main = Color3.fromRGB(80, 120, 200),
        Light = Color3.fromRGB(100, 150, 230),
        Dark = Color3.fromRGB(60, 100, 170),
        Debug = Color3.fromRGB(100, 140, 220)
    },
    Red = {
        Main = Color3.fromRGB(200, 80, 80),
        Light = Color3.fromRGB(230, 100, 100),
        Dark = Color3.fromRGB(170, 60, 60),
        Debug = Color3.fromRGB(220, 100, 100)
    },
    Green = {
        Main = Color3.fromRGB(80, 200, 120),
        Light = Color3.fromRGB(100, 230, 150),
        Dark = Color3.fromRGB(60, 170, 100),
        Debug = Color3.fromRGB(90, 210, 130)
    },
    Orange = {
        Main = Color3.fromRGB(220, 140, 60),
        Light = Color3.fromRGB(240, 160, 80),
        Dark = Color3.fromRGB(190, 120, 50),
        Debug = Color3.fromRGB(230, 150, 70)
    },
    Pink = {
        Main = Color3.fromRGB(220, 100, 160),
        Light = Color3.fromRGB(240, 130, 190),
        Dark = Color3.fromRGB(190, 80, 140),
        Debug = Color3.fromRGB(230, 110, 170)
    }
}

-- Debugger configuration
local DebugConfig = {
    DefaultPosition = UDim2.new(1, -320, 0, 20),  -- Top right corner
    DefaultSize = {300, 250},
    MaxLogs = 50,
    AutoScroll = true,
    ShowTimestamp = true,
    ShowErrorLevel = true,
    DefaultVisible = true
}

-- Utility functions
local function MakeDraggable(frame, dragFrame)
    local dragging, dragInput, dragStart, startPos
    
    dragFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    dragFrame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end
end

local function AddCorner(frame, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 8)
    corner.Parent = frame
    return corner
end

local function AddStroke(frame, thickness, color)
    local stroke = Instance.new("UIStroke")
    stroke.Thickness = thickness or 1
    stroke.Color = color or Color3.fromRGB(0, 0, 0)
    stroke.Parent = frame
    return stroke
end

-- ========================================
-- DEBUGGER SYSTEM
-- ========================================
Library.Debugger = {
    Logs = {},
    ErrorCount = 0,
    WarningCount = 0,
    InfoCount = 0
}

function Library:CreateDebugger()
    if self.Debugger.Window then
        return self.Debugger.Window
    end
    
    -- Create Debugger ScreenGui
    local DebugGui = Instance.new("ScreenGui")
    DebugGui.Name = "CustomUIDebugger"
    DebugGui.ResetOnSpawn = false
    DebugGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    DebugGui.Parent = CoreGui
    
    -- Debugger Main Frame
    local DebugFrame = Instance.new("Frame")
    DebugFrame.Name = "DebugFrame"
    DebugFrame.Size = UDim2.new(0, DebugConfig.DefaultSize[1], 0, DebugConfig.DefaultSize[2])
    DebugFrame.Position = DebugConfig.DefaultPosition
    DebugFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    DebugFrame.BorderSizePixel = 0
    DebugFrame.Visible = DebugConfig.DefaultVisible
    DebugFrame.Parent = DebugGui
    AddCorner(DebugFrame, 10)
    AddStroke(DebugFrame, 1, Color3.fromRGB(60, 60, 70))
    
    -- Debugger Top Bar
    local DebugTopBar = Instance.new("Frame")
    DebugTopBar.Name = "DebugTopBar"
    DebugTopBar.Size = UDim2.new(1, 0, 0, 32)
    DebugTopBar.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    DebugTopBar.BorderSizePixel = 0
    DebugTopBar.Parent = DebugFrame
    AddCorner(DebugTopBar, 10)
    
    -- Title
    local DebugTitle = Instance.new("TextLabel")
    DebugTitle.Size = UDim2.new(0.7, 0, 1, 0)
    DebugTitle.Position = UDim2.new(0, 10, 0, 0)
    DebugTitle.BackgroundTransparency = 1
    DebugTitle.Text = "ðŸ“Š Debug Console"
    DebugTitle.Font = Enum.Font.GothamBold
    DebugTitle.TextSize = 14
    DebugTitle.TextColor3 = Color3.fromRGB(220, 220, 230)
    DebugTitle.TextXAlignment = Enum.TextXAlignment.Left
    DebugTitle.Parent = DebugTopBar
    
    -- Status Indicators
    local ErrorIndicator = Instance.new("TextLabel")
    ErrorIndicator.Size = UDim2.new(0, 40, 0, 20)
    ErrorIndicator.Position = UDim2.new(0.7, 5, 0.5, -10)
    ErrorIndicator.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    ErrorIndicator.Text = "E:0"
    ErrorIndicator.Font = Enum.Font.GothamBold
    ErrorIndicator.TextSize = 11
    ErrorIndicator.TextColor3 = Color3.fromRGB(255, 255, 255)
    ErrorIndicator.Parent = DebugTopBar
    AddCorner(ErrorIndicator, 4)
    
    local WarningIndicator = Instance.new("TextLabel")
    WarningIndicator.Size = UDim2.new(0, 40, 0, 20)
    WarningIndicator.Position = UDim2.new(0.8, 5, 0.5, -10)
    WarningIndicator.BackgroundColor3 = Color3.fromRGB(220, 140, 60)
    WarningIndicator.Text = "W:0"
    WarningIndicator.Font = Enum.Font.GothamBold
    WarningIndicator.TextSize = 11
    WarningIndicator.TextColor3 = Color3.fromRGB(255, 255, 255)
    WarningIndicator.Parent = DebugTopBar
    AddCorner(WarningIndicator, 4)
    
    -- Close Button
    local DebugCloseButton = Instance.new("TextButton")
    DebugCloseButton.Size = UDim2.new(0, 30, 0, 30)
    DebugCloseButton.Position = UDim2.new(1, -35, 0, 1)
    DebugCloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    DebugCloseButton.BorderSizePixel = 0
    DebugCloseButton.Text = "Ã—"
    DebugCloseButton.Font = Enum.Font.GothamBold
    DebugCloseButton.TextSize = 18
    DebugCloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    DebugCloseButton.Parent = DebugTopBar
    AddCorner(DebugCloseButton, 6)
    
    DebugCloseButton.MouseButton1Click:Connect(function()
        DebugFrame.Visible = false
    end)
    
    -- Logs Container
    local LogsContainer = Instance.new("ScrollingFrame")
    LogsContainer.Name = "LogsContainer"
    LogsContainer.Size = UDim2.new(1, -10, 1, -42)
    LogsContainer.Position = UDim2.new(0, 5, 0, 37)
    LogsContainer.BackgroundTransparency = 1
    LogsContainer.BorderSizePixel = 0
    LogsContainer.ScrollBarThickness = 4
    LogsContainer.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
    LogsContainer.AutomaticCanvasSize = Enum.AutomaticSize.Y
    LogsContainer.Parent = DebugFrame
    
    local LogsLayout = Instance.new("UIListLayout")
    LogsLayout.SortOrder = Enum.SortOrder.LayoutOrder
    LogsLayout.Padding = UDim.new(0, 3)
    LogsLayout.Parent = LogsContainer
    
    -- Control Buttons
    local ControlFrame = Instance.new("Frame")
    ControlFrame.Size = UDim2.new(1, 0, 0, 30)
    ControlFrame.Position = UDim2.new(0, 0, 1, -30)
    ControlFrame.BackgroundTransparency = 1
    ControlFrame.Parent = DebugFrame
    
    local ClearButton = Instance.new("TextButton")
    ClearButton.Size = UDim2.new(0.3, -5, 0, 25)
    ClearButton.Position = UDim2.new(0.02, 0, 0, 2)
    ClearButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    ClearButton.BorderSizePixel = 0
    ClearButton.Text = "ðŸ§¹ Clear"
    ClearButton.Font = Enum.Font.GothamSemibold
    ClearButton.TextSize = 12
    ClearButton.TextColor3 = Color3.fromRGB(220, 220, 230)
    ClearButton.Parent = ControlFrame
    AddCorner(ClearButton, 5)
    
    local CopyButton = Instance.new("TextButton")
    CopyButton.Size = UDim2.new(0.3, -5, 0, 25)
    CopyButton.Position = UDim2.new(0.35, 0, 0, 2)
    CopyButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    CopyButton.BorderSizePixel = 0
    CopyButton.Text = "ðŸ“‹ Copy"
    CopyButton.Font = Enum.Font.GothamSemibold
    CopyButton.TextSize = 12
    CopyButton.TextColor3 = Color3.fromRGB(220, 220, 230)
    CopyButton.Parent = ControlFrame
    AddCorner(CopyButton, 5)
    
    local ToggleButton = Instance.new("TextButton")
    ToggleButton.Size = UDim2.new(0.3, -5, 0, 25)
    ToggleButton.Position = UDim2.new(0.68, 0, 0, 2)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    ToggleButton.BorderSizePixel = 0
    ToggleButton.Text = "ðŸ‘ï¸ Hide"
    ToggleButton.Font = Enum.Font.GothamSemibold
    ToggleButton.TextSize = 12
    ToggleButton.TextColor3 = Color3.fromRGB(220, 220, 230)
    ToggleButton.Parent = ControlFrame
    AddCorner(ToggleButton, 5)
    
    -- Make draggable
    MakeDraggable(DebugFrame, DebugTopBar)
    
    -- Store references
    self.Debugger.Window = {
        Gui = DebugGui,
        Frame = DebugFrame,
        LogsContainer = LogsContainer,
        ErrorIndicator = ErrorIndicator,
        WarningIndicator = WarningIndicator,
        Title = DebugTitle
    }
    
    -- Button functionality
    ClearButton.MouseButton1Click:Connect(function()
        self.Debugger:ClearLogs()
    end)
    
    CopyButton.MouseButton1Click:Connect(function()
        self.Debugger:CopyLogs()
    end)
    
    ToggleButton.MouseButton1Click:Connect(function()
        DebugFrame.Visible = not DebugFrame.Visible
        ToggleButton.Text = DebugFrame.Visible and "ðŸ‘ï¸ Hide" or "ðŸ‘ï¸ Show"
    end)
    
    return self.Debugger.Window
end

-- Debugger methods
function Library.Debugger:Log(message, level, source)
    level = level or "INFO"
    source = source or "Script"
    
    local timestamp = os.date("%H:%M:%S")
    local logEntry = {
        Message = message,
        Level = level:upper(),
        Source = source,
        Timestamp = timestamp,
        Color = self:GetLevelColor(level)
    }
    
    table.insert(self.Logs, logEntry)
    
    -- Update counters
    if level == "ERROR" then
        self.ErrorCount = self.ErrorCount + 1
        if self.Window and self.Window.ErrorIndicator then
            self.Window.ErrorIndicator.Text = "E:" .. self.ErrorCount
        end
    elseif level == "WARNING" then
        self.WarningCount = self.WarningCount + 1
        if self.Window and self.Window.WarningIndicator then
            self.Window.WarningIndicator.Text = "W:" .. self.WarningCount
        end
    else
        self.InfoCount = self.InfoCount + 1
    end
    
    -- Trim logs if too many
    if #self.Logs > DebugConfig.MaxLogs then
        table.remove(self.Logs, 1)
    end
    
    -- Update UI
    self:UpdateLogDisplay()
    
    -- Also print to console
    local formattedMessage = string.format("[%s] [%s] %s: %s", timestamp, level, source, message)
    print(formattedMessage)
    
    return logEntry
end

function Library.Debugger:GetLevelColor(level)
    level = level:upper()
    if level == "ERROR" then
        return Color3.fromRGB(255, 100, 100)
    elseif level == "WARNING" then
        return Color3.fromRGB(255, 200, 100)
    elseif level == "SUCCESS" then
        return Color3.fromRGB(100, 255, 100)
    else
        return Color3.fromRGB(200, 200, 200)
    end
end

function Library.Debugger:UpdateLogDisplay()
    if not self.Window or not self.Window.LogsContainer then
        return
    end
    
    -- Clear existing logs
    for _, child in ipairs(self.Window.LogsContainer:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    -- Add logs (newest first)
    for i = #self.Logs, 1, -1 do
        local log = self.Logs[i]
        self:CreateLogEntry(log)
    end
    
    -- Auto-scroll to bottom
    if DebugConfig.AutoScroll then
        task.wait()
        self.Window.LogsContainer.CanvasPosition = Vector2.new(0, self.Window.LogsContainer.CanvasSize.Y.Offset)
    end
end

function Library.Debugger:CreateLogEntry(log)
    local LogEntry = Instance.new("Frame")
    LogEntry.Size = UDim2.new(1, 0, 0, 24)
    LogEntry.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    LogEntry.BackgroundTransparency = 0.5
    LogEntry.BorderSizePixel = 0
    LogEntry.Parent = self.Window.LogsContainer
    AddCorner(LogEntry, 4)
    
    -- Level indicator
    local LevelIndicator = Instance.new("Frame")
    LevelIndicator.Size = UDim2.new(0, 4, 1, 0)
    LevelIndicator.BackgroundColor3 = log.Color
    LevelIndicator.BorderSizePixel = 0
    LevelIndicator.Parent = LogEntry
    
    -- Level text
    local LevelText = Instance.new("TextLabel")
    LevelText.Size = UDim2.new(0, 50, 1, 0)
    LevelText.Position = UDim2.new(0, 6, 0, 0)
    LevelText.BackgroundTransparency = 1
    LevelText.Text = string.sub(log.Level, 1, 4)
    LevelText.Font = Enum.Font.GothamBold
    LevelText.TextSize = 10
    LevelText.TextColor3 = log.Color
    LevelText.TextXAlignment = Enum.TextXAlignment.Left
    LevelText.Parent = LogEntry
    
    -- Timestamp
    local TimeText = Instance.new("TextLabel")
    TimeText.Size = UDim2.new(0, 50, 1, 0)
    TimeText.Position = UDim2.new(0, 60, 0, 0)
    TimeText.BackgroundTransparency = 1
    TimeText.Text = log.Timestamp
    TimeText.Font = Enum.Font.Gotham
    TimeText.TextSize = 10
    TimeText.TextColor3 = Color3.fromRGB(150, 150, 160)
    TimeText.TextXAlignment = Enum.TextXAlignment.Left
    TimeText.Parent = LogEntry
    
    -- Message
    local MessageText = Instance.new("TextLabel")
    MessageText.Size = UDim2.new(1, -120, 1, 0)
    MessageText.Position = UDim2.new(0, 115, 0, 0)
    MessageText.BackgroundTransparency = 1
    MessageText.Text = log.Message
    MessageText.Font = Enum.Font.Gotham
    MessageText.TextSize = 10
    MessageText.TextColor3 = Color3.fromRGB(220, 220, 230)
    MessageText.TextXAlignment = Enum.TextXAlignment.Left
    MessageText.TextTruncate = Enum.TextTruncate.AtEnd
    MessageText.Parent = LogEntry
    
    -- Tooltip for full message
    MessageText.MouseEnter:Connect(function()
        local Tooltip = Instance.new("TextLabel")
        Tooltip.Text = log.Message
        Tooltip.Size = UDim2.new(0, 200, 0, 0)
        Tooltip.Position = UDim2.new(0, 0, 1, 2)
        Tooltip.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        Tooltip.TextColor3 = Color3.fromRGB(220, 220, 230)
        Tooltip.Font = Enum.Font.Gotham
        Tooltip.TextSize = 10
        Tooltip.TextWrapped = true
        Tooltip.ZIndex = 100
        Tooltip.AutomaticSize = Enum.AutomaticSize.Y
        Tooltip.Parent = MessageText
        AddCorner(Tooltip, 4)
        AddStroke(Tooltip, 1, Color3.fromRGB(60, 60, 70))
    end)
    
    MessageText.MouseLeave:Connect(function()
        for _, child in ipairs(MessageText:GetChildren()) do
            child:Destroy()
        end
    end)
end

function Library.Debugger:ClearLogs()
    self.Logs = {}
    self.ErrorCount = 0
    self.WarningCount = 0
    self.InfoCount = 0
    
    if self.Window then
        if self.Window.ErrorIndicator then
            self.Window.ErrorIndicator.Text = "E:0"
        end
        if self.Window.WarningIndicator then
            self.Window.WarningIndicator.Text = "W:0"
        end
        self:UpdateLogDisplay()
    end
    
    self:Log("Logs cleared", "INFO", "Debugger")
end

function Library.Debugger:CopyLogs()
    local logText = ""
    for i, log in ipairs(self.Logs) do
        logText = logText .. string.format("[%s] [%s] %s\n", log.Timestamp, log.Level, log.Message)
    end
    
    -- For Roblox, we'd need to use setclipboard if available
    pcall(function()
        setclipboard(logText)
    end)
    
    self:Log("Logs copied to clipboard", "SUCCESS", "Debugger")
end

function Library.Debugger:Error(message, source)
    return self:Log(message, "ERROR", source)
end

function Library.Debugger:Warning(message, source)
    return self:Log(message, "WARNING", source)
end

function Library.Debugger:Success(message, source)
    return self:Log(message, "SUCCESS", source)
end

function Library.Debugger:Info(message, source)
    return self:Log(message, "INFO", source)
end

-- Create debugger toggle for any tab
function Library:CreateDebuggerToggle(tab)
    if not tab or not tab.AddToggle then
        self.Debugger:Error("Invalid tab provided for debugger toggle", "Library")
        return nil
    end
    
    local toggle = tab:AddToggle({
        Name = "Debug Console",
        Default = DebugConfig.DefaultVisible,
        Callback = function(value)
            if self.Debugger.Window and self.Debugger.Window.Frame then
                self.Debugger.Window.Frame.Visible = value
                self.Debugger:Log(
                    value and "Debug console shown" or "Debug console hidden",
                    "INFO",
                    "Debugger"
                )
            end
        end
    })
    
    return toggle
end

-- Hook into print function to auto-log
local originalPrint = print
function Library:HookPrint()
    print = function(...)
        local args = {...}
        local message = ""
        for i, arg in ipairs(args) do
            message = message .. tostring(arg) .. (i < #args and "\t" or "")
        end
        
        -- Log to debugger
        self.Debugger:Info(message, "print")
        
        -- Call original print
        originalPrint(...)
    end
end

-- ========================================
-- ORIGINAL LIBRARY FUNCTIONS (FIXED VERSION)
-- ========================================

-- Create main window
function Library:CreateWindow(config)
    config = config or {}
    config.Title = config.Title or "UI Library"
    config.Subtitle = config.Subtitle or "by @username"
    config.Theme = config.Theme or "Purple"
    config.Size = config.Size or {550, 400}
    config.ToggleKey = config.ToggleKey or Enum.KeyCode.K
    
    local Window = {}
    Window.Theme = Themes[config.Theme] or Themes.Purple
    Window.Tabs = {}
    Window.CurrentTab = nil
    
    -- Log window creation
    self.Debugger:Log(string.format("Creating window: '%s'", config.Title), "INFO", "Library")
    
    -- Create ScreenGui
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "CustomUILibrary"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Protection against deletion
    pcall(function()
        ScreenGui.Parent = CoreGui
    end)
    if not ScreenGui.Parent then
        ScreenGui.Parent = player.PlayerGui
    end
    
    -- Main Frame
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, config.Size[1], 0, config.Size[2])
    MainFrame.Position = UDim2.new(0.5, -config.Size[1]/2, 0.5, -config.Size[2]/2)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui
    AddCorner(MainFrame, 12)
    
    -- Top Bar
    local TopBar = Instance.new("Frame")
    TopBar.Name = "TopBar"
    TopBar.Size = UDim2.new(1, 0, 0, 50)
    TopBar.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    TopBar.BorderSizePixel = 0
    TopBar.Parent = MainFrame
    AddCorner(TopBar, 12)
    
    -- Fix bottom corners of top bar
    local TopBarFix = Instance.new("Frame")
    TopBarFix.Size = UDim2.new(1, 0, 0, 12)
    TopBarFix.Position = UDim2.new(0, 0, 1, -12)
    TopBarFix.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    TopBarFix.BorderSizePixel = 0
    TopBarFix.Parent = TopBar
    
    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(0, 300, 0, 20)
    Title.Position = UDim2.new(0, 20, 0, 8)
    Title.BackgroundTransparency = 1
    Title.Text = config.Title
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Title.TextColor3 = Window.Theme.Light
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = TopBar
    
    -- Subtitle
    local Subtitle = Instance.new("TextLabel")
    Subtitle.Size = UDim2.new(0, 300, 0, 15)
    Subtitle.Position = UDim2.new(0, 20, 0, 28)
    Subtitle.BackgroundTransparency = 1
    Subtitle.Text = config.Subtitle
    Subtitle.Font = Enum.Font.Gotham
    Subtitle.TextSize = 12
    Subtitle.TextColor3 = Color3.fromRGB(150, 150, 160)
    Subtitle.TextXAlignment = Enum.TextXAlignment.Left
    Subtitle.Parent = TopBar
    
    -- Close Button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 40, 0, 40)
    CloseButton.Position = UDim2.new(1, -50, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
    CloseButton.BorderSizePixel = 0
    CloseButton.Text = "Ã—"
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.TextSize = 24
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.Parent = TopBar
    AddCorner(CloseButton, 8)
    
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
        self.Debugger:Log("Window closed", "INFO", "Library")
    end)
    
    -- Tab Container (left side)
    local TabContainer = Instance.new("Frame")
    TabContainer.Name = "TabContainer"
    TabContainer.Size = UDim2.new(0, 150, 1, -60)
    TabContainer.Position = UDim2.new(0, 10, 0, 60)
    TabContainer.BackgroundTransparency = 1
    TabContainer.Parent = MainFrame
    
    local TabLayout = Instance.new("UIListLayout")
    TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    TabLayout.Padding = UDim.new(0, 8)
    TabLayout.Parent = TabContainer
    
    -- Content Container (right side)
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Name = "ContentContainer"
    ContentContainer.Size = UDim2.new(1, -170, 1, -70)
    ContentContainer.Position = UDim2.new(0, 165, 0, 60)
    ContentContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    ContentContainer.BorderSizePixel = 0
    ContentContainer.Parent = MainFrame
    AddCorner(ContentContainer, 10)
    
    -- Make draggable
    MakeDraggable(MainFrame, TopBar)
    
    -- Toggle UI with keybind
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end
        if input.KeyCode == config.ToggleKey then
            MainFrame.Visible = not MainFrame.Visible
            self.Debugger:Log(
                string.format("UI toggled %s", MainFrame.Visible and "visible" or "hidden"),
                "INFO",
                "Library"
            )
        end
    end)
    
    Window.ScreenGui = ScreenGui
    Window.MainFrame = MainFrame
    Window.TabContainer = TabContainer
    Window.ContentContainer = ContentContainer
    Window.Library = self -- Store library reference for debugger access
    
    -- Create Tab function
    function Window:CreateTab(name)
        self.Library.Debugger:Log(string.format("Creating tab: '%s'", name), "INFO", "Library")
        
        local Tab = {}
        Tab.Name = name
        Tab.Elements = {}
        Tab.Window = self -- Store window reference
        
        -- Tab Button
        local TabButton = Instance.new("TextButton")
        TabButton.Name = name
        TabButton.Size = UDim2.new(1, 0, 0, 40)
        TabButton.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
        TabButton.BorderSizePixel = 0
        TabButton.Text = name
        TabButton.Font = Enum.Font.GothamSemibold
        TabButton.TextSize = 14
        TabButton.TextColor3 = Color3.fromRGB(180, 180, 190)
        TabButton.Parent = TabContainer
        AddCorner(TabButton, 8)
        
        -- Tab Content (ScrollingFrame)
        local TabContent = Instance.new("ScrollingFrame")
        TabContent.Name = name .. "Content"
        TabContent.Size = UDim2.new(1, -20, 1, -20)
        TabContent.Position = UDim2.new(0, 10, 0, 10)
        TabContent.BackgroundTransparency = 1
        TabContent.BorderSizePixel = 0
        TabContent.ScrollBarThickness = 4
        TabContent.ScrollBarImageColor3 = self.Theme.Light
        TabContent.Visible = false
        TabContent.Parent = ContentContainer
        
        local ContentLayout = Instance.new("UIListLayout")
        ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
        ContentLayout.Padding = UDim.new(0, 10)
        ContentLayout.Parent = TabContent
        
        -- Auto-resize canvas
        ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            TabContent.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
        end)
        
        -- Switch to this tab when clicked
        TabButton.MouseButton1Click:Connect(function()
            for _, tab in pairs(self.Tabs) do
                tab.Button.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
                tab.Button.TextColor3 = Color3.fromRGB(180, 180, 190)
                tab.Content.Visible = false
            end
            
            TabButton.BackgroundColor3 = self.Theme.Main
            TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            TabContent.Visible = true
            self.CurrentTab = name
            
            self.Library.Debugger:Log(string.format("Switched to tab: '%s'", name), "INFO", "Library")
        end)
        
        -- Auto-select first tab
        if not self.CurrentTab then
            TabButton.BackgroundColor3 = self.Theme.Main
            TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            TabContent.Visible = true
            self.CurrentTab = name
        end
        
        Tab.Button = TabButton
        Tab.Content = TabContent
        Tab.Theme = self.Theme
        Tab.Library = self.Library
        self.Tabs[name] = Tab
        
        -- ========================================
        -- ADD TOGGLE (with debugger integration)
        -- ========================================
        function Tab:AddToggle(config)
            config = config or {}
            config.Name = config.Name or "Toggle"
            config.Default = config.Default or false
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating toggle: '%s'", config.Name), "INFO", "Library")
            
            local ToggleFrame = Instance.new("Frame")
            ToggleFrame.Size = UDim2.new(1, 0, 0, 45)
            ToggleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            ToggleFrame.BorderSizePixel = 0
            ToggleFrame.Parent = TabContent
            AddCorner(ToggleFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(1, -70, 1, 0)
            Label.Position = UDim2.new(0, 15, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = ToggleFrame
            
            local ToggleButton = Instance.new("TextButton")
            ToggleButton.Size = UDim2.new(0, 50, 0, 25)
            ToggleButton.Position = UDim2.new(1, -60, 0.5, -12.5)
            ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            ToggleButton.BorderSizePixel = 0
            ToggleButton.Text = ""
            ToggleButton.Parent = ToggleFrame
            AddCorner(ToggleButton, 25)
            
            local Indicator = Instance.new("Frame")
            Indicator.Size = UDim2.new(0, 21, 0, 21)
            Indicator.Position = UDim2.new(0, 2, 0.5, -10.5)
            Indicator.BackgroundColor3 = Color3.fromRGB(200, 200, 210)
            Indicator.BorderSizePixel = 0
            Indicator.Parent = ToggleButton
            AddCorner(Indicator, 25)
            
            local toggled = config.Default
            
            local function UpdateToggle()
                if toggled then
                    TweenService:Create(ToggleButton, TweenInfo.new(0.2), {BackgroundColor3 = self.Theme.Main}):Play()
                    TweenService:Create(Indicator, TweenInfo.new(0.2), {Position = UDim2.new(1, -23, 0.5, -10.5)}):Play()
                else
                    TweenService:Create(ToggleButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 55)}):Play()
                    TweenService:Create(Indicator, TweenInfo.new(0.2), {Position = UDim2.new(0, 2, 0.5, -10.5)}):Play()
                end
            end
            
            UpdateToggle()
            
            ToggleButton.MouseButton1Click:Connect(function()
                toggled = not toggled
                UpdateToggle()
                
                -- Log the toggle action
                self.Library.Debugger:Log(
                    string.format("Toggle '%s': %s", config.Name, toggled and "ON" or "OFF"),
                    "INFO",
                    "UI"
                )
                
                -- Call callback with error handling
                local success, err = pcall(config.Callback, toggled)
                if not success then
                    self.Library.Debugger:Error(
                        string.format("Toggle callback error: %s", err),
                        config.Name
                    )
                end
            end)
            
            -- Return control object
            return {
                Set = function(_, value)
                    toggled = value
                    UpdateToggle()
                    local success, err = pcall(config.Callback, toggled)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Toggle Set() error: %s", err),
                            config.Name
                        )
                    end
                end,
                Get = function()
                    return toggled
                end
            }
        end
        
        -- ========================================
        -- ADD SLIDER (with debugger integration)
        -- ========================================
        function Tab:AddSlider(config)
            config = config or {}
            config.Name = config.Name or "Slider"
            config.Min = config.Min or 0
            config.Max = config.Max or 100
            config.Default = config.Default or 50
            config.Increment = config.Increment or 1
            config.Suffix = config.Suffix or ""
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating slider: '%s'", config.Name), "INFO", "Library")
            
            local SliderFrame = Instance.new("Frame")
            SliderFrame.Size = UDim2.new(1, 0, 0, 60)
            SliderFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            SliderFrame.BorderSizePixel = 0
            SliderFrame.Parent = TabContent
            AddCorner(SliderFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(0.6, 0, 0, 20)
            Label.Position = UDim2.new(0, 15, 0, 8)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = SliderFrame
            
            local ValueLabel = Instance.new("TextLabel")
            ValueLabel.Size = UDim2.new(0.3, 0, 0, 20)
            ValueLabel.Position = UDim2.new(0.7, -15, 0, 8)
            ValueLabel.BackgroundTransparency = 1
            ValueLabel.Text = tostring(config.Default) .. config.Suffix
            ValueLabel.Font = Enum.Font.GothamBold
            ValueLabel.TextSize = 13
            ValueLabel.TextColor3 = self.Theme.Light
            ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
            ValueLabel.Parent = SliderFrame
            
            local SliderBar = Instance.new("Frame")
            SliderBar.Size = UDim2.new(1, -30, 0, 6)
            SliderBar.Position = UDim2.new(0, 15, 1, -20)
            SliderBar.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            SliderBar.BorderSizePixel = 0
            SliderBar.Parent = SliderFrame
            AddCorner(SliderBar, 10)
            
            local SliderFill = Instance.new("Frame")
            SliderFill.Size = UDim2.new(0, 0, 1, 0)
            SliderFill.BackgroundColor3 = self.Theme.Main
            SliderFill.BorderSizePixel = 0
            SliderFill.Parent = SliderBar
            AddCorner(SliderFill, 10)
            
            local dragging = false
            local currentValue = config.Default
            
            local function UpdateSlider(input)
                local pos = math.clamp((input.Position.X - SliderBar.AbsolutePosition.X) / SliderBar.AbsoluteSize.X, 0, 1)
                local value = config.Min + (config.Max - config.Min) * pos
                value = math.floor(value / config.Increment + 0.5) * config.Increment
                currentValue = value
                
                SliderFill.Size = UDim2.new(pos, 0, 1, 0)
                ValueLabel.Text = tostring(value) .. config.Suffix
                
                -- Log slider changes
                if not dragging then
                    self.Library.Debugger:Log(
                        string.format("Slider '%s': %s", config.Name, ValueLabel.Text),
                        "INFO",
                        "UI"
                    )
                end
                
                -- Call callback with error handling
                local success, err = pcall(config.Callback, value)
                if not success then
                    self.Library.Debugger:Error(
                        string.format("Slider callback error: %s", err),
                        config.Name
                    )
                end
            end
            
            SliderBar.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    UpdateSlider(input)
                end
            end)
            
            SliderBar.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                    self.Library.Debugger:Log(
                        string.format("Slider '%s' set to: %s", config.Name, ValueLabel.Text),
                        "INFO",
                        "UI"
                    )
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    UpdateSlider(input)
                end
            end)
            
            -- Initialize position
            local initPos = (currentValue - config.Min) / (config.Max - config.Min)
            SliderFill.Size = UDim2.new(initPos, 0, 1, 0)
            
            -- Return control object
            return {
                Set = function(_, value)
                    value = math.clamp(value, config.Min, config.Max)
                    currentValue = value
                    local pos = (value - config.Min) / (config.Max - config.Min)
                    SliderFill.Size = UDim2.new(pos, 0, 1, 0)
                    ValueLabel.Text = tostring(value) .. config.Suffix
                    
                    local success, err = pcall(config.Callback, value)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Slider Set() error: %s", err),
                            config.Name
                        )
                    end
                end,
                Get = function()
                    return currentValue
                end
            }
        end
        
        -- ========================================
        -- ADD BUTTON (with debugger integration)
        -- ========================================
        function Tab:AddButton(config)
            config = config or {}
            config.Name = config.Name or "Button"
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating button: '%s'", config.Name), "INFO", "Library")
            
            local ButtonFrame = Instance.new("TextButton")
            ButtonFrame.Size = UDim2.new(1, 0, 0, 40)
            ButtonFrame.BackgroundColor3 = self.Theme.Main
            ButtonFrame.BorderSizePixel = 0
            ButtonFrame.Text = config.Name
            ButtonFrame.Font = Enum.Font.GothamBold
            ButtonFrame.TextSize = 14
            ButtonFrame.TextColor3 = Color3.fromRGB(255, 255, 255)
            ButtonFrame.Parent = TabContent
            AddCorner(ButtonFrame, 8)
            
            ButtonFrame.MouseButton1Click:Connect(function()
                TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {BackgroundColor3 = self.Theme.Dark}):Play()
                wait(0.1)
                TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {BackgroundColor3 = self.Theme.Main}):Play()
                
                -- Log button click
                self.Library.Debugger:Log(
                    string.format("Button clicked: '%s'", config.Name),
                    "INFO",
                    "UI"
                )
                
                -- Call callback with error handling
                local success, err = pcall(config.Callback)
                if not success then
                    self.Library.Debugger:Error(
                        string.format("Button callback error: %s", err),
                        config.Name
                    )
                end
            end)
            
            return {
                Fire = function()
                    ButtonFrame.MouseButton1Click:Fire()
                end
            }
        end
        
        -- ========================================
        -- ADD KEYBIND (with debugger integration)
        -- ========================================
        function Tab:AddKeybind(config)
            config = config or {}
            config.Name = config.Name or "Keybind"
            config.Default = config.Default or Enum.KeyCode.E
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating keybind: '%s'", config.Name), "INFO", "Library")
            
            local KeybindFrame = Instance.new("Frame")
            KeybindFrame.Size = UDim2.new(1, 0, 0, 45)
            KeybindFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            KeybindFrame.BorderSizePixel = 0
            KeybindFrame.Parent = TabContent
            AddCorner(KeybindFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(0.5, 0, 1, 0)
            Label.Position = UDim2.new(0, 15, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = KeybindFrame
            
            local KeyButton = Instance.new("TextButton")
            KeyButton.Size = UDim2.new(0, 80, 0, 28)
            KeyButton.Position = UDim2.new(1, -90, 0.5, -14)
            KeyButton.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            KeyButton.BorderSizePixel = 0
            KeyButton.Text = config.Default.Name
            KeyButton.Font = Enum.Font.GothamBold
            KeyButton.TextSize = 12
            KeyButton.TextColor3 = Color3.fromRGB(200, 200, 210)
            KeyButton.Parent = KeybindFrame
            AddCorner(KeyButton, 6)
            
            local listening = false
            local currentKey = config.Default
            
            KeyButton.MouseButton1Click:Connect(function()
                listening = true
                KeyButton.Text = "..."
                KeyButton.BackgroundColor3 = self.Theme.Main
                self.Library.Debugger:Log(
                    string.format("Listening for keybind: '%s'", config.Name),
                    "INFO",
                    "UI"
                )
            end)
            
            UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if listening and not gameProcessed then
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        currentKey = input.KeyCode
                        KeyButton.Text = input.KeyCode.Name
                        KeyButton.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
                        listening = false
                        
                        self.Library.Debugger:Log(
                            string.format("Keybind '%s' set to: %s", config.Name, input.KeyCode.Name),
                            "SUCCESS",
                            "UI"
                        )
                        
                        local success, err = pcall(config.Callback, input.KeyCode)
                        if not success then
                            self.Library.Debugger:Error(
                                string.format("Keybind callback error: %s", err),
                                config.Name
                            )
                        end
                    end
                end
            end)
            
            -- Return control object
            return {
                Set = function(_, key)
                    currentKey = key
                    KeyButton.Text = key.Name
                    local success, err = pcall(config.Callback, key)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Keybind Set() error: %s", err),
                            config.Name
                        )
                    end
                end,
                Get = function()
                    return currentKey
                end
            }
        end
        
        -- ========================================
        -- ADD DROPDOWN (with debugger integration)
        -- ========================================
        function Tab:AddDropdown(config)
            config = config or {}
            config.Name = config.Name or "Dropdown"
            config.Options = config.Options or {"Option 1", "Option 2"}
            config.Default = config.Default or config.Options[1]
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating dropdown: '%s'", config.Name), "INFO", "Library")
            
            local DropdownFrame = Instance.new("Frame")
            DropdownFrame.Size = UDim2.new(1, 0, 0, 45)
            DropdownFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            DropdownFrame.BorderSizePixel = 0
            DropdownFrame.Parent = TabContent
            DropdownFrame.ClipsDescendants = true
            AddCorner(DropdownFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(0.5, 0, 0, 45)
            Label.Position = UDim2.new(0, 15, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = DropdownFrame
            
            local DropButton = Instance.new("TextButton")
            DropButton.Size = UDim2.new(0, 140, 0, 28)
            DropButton.Position = UDim2.new(1, -150, 0, 8.5)
            DropButton.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            DropButton.BorderSizePixel = 0
            DropButton.Text = config.Default .. " â–¼"
            DropButton.Font = Enum.Font.GothamSemibold
            DropButton.TextSize = 12
            DropButton.TextColor3 = Color3.fromRGB(200, 200, 210)
            DropButton.Parent = DropdownFrame
            AddCorner(DropButton, 6)
            
            local OptionsList = Instance.new("Frame")
            OptionsList.Size = UDim2.new(0, 140, 0, 0)
            OptionsList.Position = UDim2.new(1, -150, 0, 45)
            OptionsList.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
            OptionsList.BorderSizePixel = 0
            OptionsList.Visible = false
            OptionsList.Parent = DropdownFrame
            AddCorner(OptionsList, 6)
            
            local OptionsLayout = Instance.new("UIListLayout")
            OptionsLayout.SortOrder = Enum.SortOrder.LayoutOrder
            OptionsLayout.Padding = UDim.new(0, 2)
            OptionsLayout.Parent = OptionsList
            
            local expanded = false
            local currentOption = config.Default
            
            DropButton.MouseButton1Click:Connect(function()
                expanded = not expanded
                
                if expanded then
                    OptionsList.Visible = true
                    local newSize = #config.Options * 30
                    TweenService:Create(DropdownFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 45 + newSize + 10)}):Play()
                    TweenService:Create(OptionsList, TweenInfo.new(0.2), {Size = UDim2.new(0, 140, 0, newSize)}):Play()
                    DropButton.Text = currentOption .. " â–²"
                    
                    self.Library.Debugger:Log(
                        string.format("Dropdown '%s' expanded", config.Name),
                        "INFO",
                        "UI"
                    )
                else
                    TweenService:Create(DropdownFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 45)}):Play()
                    TweenService:Create(OptionsList, TweenInfo.new(0.2), {Size = UDim2.new(0, 140, 0, 0)}):Play()
                    wait(0.2)
                    OptionsList.Visible = false
                    DropButton.Text = currentOption .. " â–¼"
                end
            end)
            
            for _, option in ipairs(config.Options) do
                local OptionButton = Instance.new("TextButton")
                OptionButton.Size = UDim2.new(1, 0, 0, 28)
                OptionButton.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
                OptionButton.BorderSizePixel = 0
                OptionButton.Text = option
                OptionButton.Font = Enum.Font.Gotham
                OptionButton.TextSize = 12
                OptionButton.TextColor3 = Color3.fromRGB(200, 200, 210)
                OptionButton.Parent = OptionsList
                AddCorner(OptionButton, 4)
                
                OptionButton.MouseButton1Click:Connect(function()
                    currentOption = option
                    DropButton.Text = option .. " â–¼"
                    expanded = false
                    TweenService:Create(DropdownFrame, TweenInfo.new(0.2), {Size = UDim2.new(1, 0, 0, 45)}):Play()
                    TweenService:Create(OptionsList, TweenInfo.new(0.2), {Size = UDim2.new(0, 140, 0, 0)}):Play()
                    wait(0.2)
                    OptionsList.Visible = false
                    
                    self.Library.Debugger:Log(
                        string.format("Dropdown '%s' selected: %s", config.Name, option),
                        "INFO",
                        "UI"
                    )
                    
                    local success, err = pcall(config.Callback, option)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Dropdown callback error: %s", err),
                            config.Name
                        )
                    end
                end)
            end
            
            return {
                Set = function(_, option)
                    currentOption = option
                    DropButton.Text = option .. " â–¼"
                    local success, err = pcall(config.Callback, option)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Dropdown Set() error: %s", err),
                            config.Name
                        )
                    end
                end,
                Get = function()
                    return currentOption
                end
            }
        end
        
        -- ========================================
        -- ADD TEXTBOX (with debugger integration)
        -- ========================================
        function Tab:AddTextbox(config)
            config = config or {}
            config.Name = config.Name or "Textbox"
            config.Default = config.Default or ""
            config.PlaceholderText = config.PlaceholderText or "Enter text..."
            config.ClearOnFocus = config.ClearOnFocus or false
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating textbox: '%s'", config.Name), "INFO", "Library")
            
            local TextboxFrame = Instance.new("Frame")
            TextboxFrame.Size = UDim2.new(1, 0, 0, 45)
            TextboxFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            TextboxFrame.BorderSizePixel = 0
            TextboxFrame.Parent = TabContent
            AddCorner(TextboxFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(0.4, 0, 1, 0)
            Label.Position = UDim2.new(0, 15, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = TextboxFrame
            
            local Textbox = Instance.new("TextBox")
            Textbox.Size = UDim2.new(0, 160, 0, 28)
            Textbox.Position = UDim2.new(1, -170, 0.5, -14)
            Textbox.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            Textbox.BorderSizePixel = 0
            Textbox.Text = config.Default
            Textbox.PlaceholderText = config.PlaceholderText
            Textbox.Font = Enum.Font.Gotham
            Textbox.TextSize = 12
            Textbox.TextColor3 = Color3.fromRGB(200, 200, 210)
            Textbox.PlaceholderColor3 = Color3.fromRGB(120, 120, 130)
            Textbox.ClearButtonEnabled = true
            Textbox.Parent = TextboxFrame
            AddCorner(Textbox, 6)
            
            if config.ClearOnFocus then
                Textbox.Focused:Connect(function()
                    Textbox.Text = ""
                end)
            end
            
            Textbox.FocusLost:Connect(function(enterPressed)
                if enterPressed then
                    self.Library.Debugger:Log(
                        string.format("Textbox '%s' entered: %s", config.Name, Textbox.Text),
                        "INFO",
                        "UI"
                    )
                    
                    local success, err = pcall(config.Callback, Textbox.Text)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Textbox callback error: %s", err),
                            config.Name
                        )
                    end
                end
            end)
            
            return {
                Set = function(_, text)
                    Textbox.Text = text
                end,
                Get = function()
                    return Textbox.Text
                end
            }
        end
        
        -- ========================================
        -- ADD COLOR PICKER (with debugger integration)
        -- ========================================
        function Tab:AddColorPicker(config)
            config = config or {}
            config.Name = config.Name or "Color Picker"
            config.Default = config.Default or Color3.fromRGB(255, 255, 255)
            config.Callback = config.Callback or function() end
            
            self.Library.Debugger:Log(string.format("Creating color picker: '%s'", config.Name), "INFO", "Library")
            
            local ColorFrame = Instance.new("Frame")
            ColorFrame.Size = UDim2.new(1, 0, 0, 45)
            ColorFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            ColorFrame.BorderSizePixel = 0
            ColorFrame.Parent = TabContent
            AddCorner(ColorFrame, 8)
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(0.6, 0, 1, 0)
            Label.Position = UDim2.new(0, 15, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = config.Name
            Label.Font = Enum.Font.GothamSemibold
            Label.TextSize = 14
            Label.TextColor3 = Color3.fromRGB(220, 220, 230)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.Parent = ColorFrame
            
            local ColorDisplay = Instance.new("Frame")
            ColorDisplay.Size = UDim2.new(0, 40, 0, 28)
            ColorDisplay.Position = UDim2.new(1, -50, 0.5, -14)
            ColorDisplay.BackgroundColor3 = config.Default
            ColorDisplay.BorderSizePixel = 0
            ColorDisplay.Parent = ColorFrame
            AddCorner(ColorDisplay, 6)
            
            local ColorButton = Instance.new("TextButton")
            ColorButton.Size = UDim2.new(1, 0, 1, 0)
            ColorButton.BackgroundTransparency = 1
            ColorButton.Text = ""
            ColorButton.Parent = ColorDisplay
            
            local currentColor = config.Default
            
            ColorButton.MouseButton1Click:Connect(function()
                -- Simple RGB slider popup (simplified version)
                local r = math.floor(currentColor.R * 255)
                local g = math.floor(currentColor.G * 255)
                local b = math.floor(currentColor.B * 255)
                
                -- Cycle through preset colors for simplicity
                local colors = {
                    Color3.fromRGB(255, 0, 0),
                    Color3.fromRGB(0, 255, 0),
                    Color3.fromRGB(0, 0, 255),
                    Color3.fromRGB(255, 255, 0),
                    Color3.fromRGB(255, 0, 255),
                    Color3.fromRGB(0, 255, 255),
                    Color3.fromRGB(255, 255, 255),
                    Color3.fromRGB(0, 0, 0)
                }
                
                local index = 1
                for i, color in ipairs(colors) do
                    if color == currentColor then
                        index = i
                        break
                    end
                end
                
                index = index % #colors + 1
                currentColor = colors[index]
                ColorDisplay.BackgroundColor3 = currentColor
                
                self.Library.Debugger:Log(
                    string.format("Color picker '%s' changed to RGB(%d, %d, %d)", 
                        config.Name, 
                        math.floor(currentColor.R * 255),
                        math.floor(currentColor.G * 255),
                        math.floor(currentColor.B * 255)
                    ),
                    "INFO",
                    "UI"
                )
                
                local success, err = pcall(config.Callback, currentColor)
                if not success then
                    self.Library.Debugger:Error(
                        string.format("Color picker callback error: %s", err),
                        config.Name
                    )
                end
            end)
            
            return {
                Set = function(_, color)
                    currentColor = color
                    ColorDisplay.BackgroundColor3 = color
                    local success, err = pcall(config.Callback, color)
                    if not success then
                        self.Library.Debugger:Error(
                            string.format("Color picker Set() error: %s", err),
                            config.Name
                        )
                    end
                end,
                Get = function()
                    return currentColor
                end
            }
        end
        
        -- ========================================
        -- ADD LABEL
        -- ========================================
        function Tab:AddLabel(text)
            local LabelFrame = Instance.new("Frame")
            LabelFrame.Size = UDim2.new(1, 0, 0, 30)
            LabelFrame.BackgroundTransparency = 1
            LabelFrame.Parent = TabContent
            
            local Label = Instance.new("TextLabel")
            Label.Size = UDim2.new(1, -20, 1, 0)
            Label.Position = UDim2.new(0, 10, 0, 0)
            Label.BackgroundTransparency = 1
            Label.Text = text
            Label.Font = Enum.Font.Gotham
            Label.TextSize = 13
            Label.TextColor3 = Color3.fromRGB(180, 180, 190)
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.TextWrapped = true
            Label.Parent = LabelFrame
            
            return {
                Set = function(_, newText)
                    Label.Text = newText
                end
            }
        end
        
        -- ========================================
        -- ADD DIVIDER
        -- ========================================
        function Tab:AddDivider()
            local DividerFrame = Instance.new("Frame")
            DividerFrame.Size = UDim2.new(1, 0, 0, 10)
            DividerFrame.BackgroundTransparency = 1
            DividerFrame.Parent = TabContent
            
            local Line = Instance.new("Frame")
            Line.Size = UDim2.new(1, -20, 0, 2)
            Line.Position = UDim2.new(0, 10, 0.5, -1)
            Line.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
            Line.BorderSizePixel = 0
            Line.Parent = DividerFrame
        end
        
        return Tab
    end
    
    -- Create debugger automatically
    self:CreateDebugger()
    
    -- Log successful window creation
    self.Debugger:Success(string.format("Window '%s' created successfully", config.Title), "Library")
    
    return Window
end

-- Initialize debugger when library is loaded
Library:CreateDebugger()

-- Log library load
Library.Debugger:Success("Custom UI Library loaded successfully", "Library")
Library.Debugger:Log("Debugger system initialized", "INFO", "Debugger")
Library.Debugger:Log("Library version: 2.0 (with Debugger)", "INFO", "System")

return Library
